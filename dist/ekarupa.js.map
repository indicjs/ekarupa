{"version":3,"file":null,"sources":["../lib/ekarupa.js"],"sourcesContent":["export function asciiToUnicode(string, map, options){\n  map = preprocessMap(map);\n  if (options === undefined) {\n    options = {};\n  }\n  if (options.LHSGreatestWidth === undefined) {\n    options.LHSGreatestWidth = calculateLHSGreatestWidth(map.map);\n  }\n  var converted = '';\n  var currIndex = 0;\n  var currentDecodedChar = '';\n  var currentOriginalChar = '';\n  processingLoop:\n  while (currIndex < string.length) {\n    currentOriginalChar = currentDecodedChar = string.slice(currIndex, currIndex + 1);\n    for (let currLHSWidth = options.LHSGreatestWidth; currLHSWidth > 0 ; currLHSWidth--) {\n      if (map.map[string.slice(currIndex, currIndex + currLHSWidth)] !== undefined) {\n        currentDecodedChar = map.map[string.slice(currIndex, currIndex + currLHSWidth)];\n        converted += currentDecodedChar;\n        currIndex += currLHSWidth;\n        // console.log(currentDecodedChar);\n        continue processingLoop;\n      }\n    }\n    converted += currentDecodedChar;\n    currIndex += 1;\n  }\n  var postProcessed = '';\n  currIndex = 0;\n  var currChar = '';\n  var baseFound = false;\n  var joiningHold = false;\n  var prebaseBuffer = '';\n  var baseBuffer = '';\n  while (currIndex < converted.length) {\n    currChar = converted.slice(currIndex, currIndex + 1);\n    if (joiningHold) {\n      currChar = joiningHold + currChar;\n      joiningHold = false;\n    }\n    if (map.prebase.includes(currChar)) {\n      if (baseFound) {\n        postProcessed += prebaseBuffer;\n        prebaseBuffer = '';\n        baseFound = false;\n      }\n      prebaseBuffer += currChar;\n    } else if (map.joiner.includes(currChar)) {\n      joiningHold = currChar;\n      // postProcessed += currChar;\n      baseFound = false;\n    } else if (map.postbase.includes(currChar)){\n      postProcessed += prebaseBuffer;\n      prebaseBuffer = '';\n      baseFound = false;\n      postProcessed += currChar;\n    } else {\n      if (baseFound === false) {\n        postProcessed += currChar;\n        baseFound = true;\n      } else {\n        postProcessed += prebaseBuffer;\n        prebaseBuffer = '';\n        postProcessed += currChar;\n      }\n    }\n    currIndex += 1;\n  }\n  for (let rule of Object.keys(map.composition)){\n    postProcessed = postProcessed.replaceAll(rule, map.composition[rule])\n  }\n  return postProcessed;\n}\n\nfunction preprocessMap(map){\n  let processedMap = {};\n  for (let item in map) {\n    if (item === 'map') {\n      let realMap = {};\n      for (let rule of Object.keys(map.map)) {\n        realMap[rule.trim()] = map.map[rule].trim();\n      }\n      realMap[' ']=' ';\n      realMap['\\n']='\\n';\n      processedMap.map = realMap;\n    } else {\n      processedMap[item] = map[item];\n    }\n  }\n  if (processedMap.prebase === undefined) {\n    processedMap.prebase = 'േ െ ൈ ്ര'.split(' ');\n  }\n  if (processedMap.postbase === undefined) {\n    processedMap.postbase = 'ാ ി ീ ു ൂ ഃ'.split(' ');\n  }\n  if (processedMap.joiner === undefined) {\n    processedMap.joiner = '്'.split(' ');\n  }\n  if (processedMap.composition === undefined) {\n    processedMap.composition = {\n      'ോ': 'ോ',\n      'ൊ': 'ൊ'\n    };\n  }\n  return processedMap;\n}\n\nString.prototype.replaceAll = function(search, replacement) {\n    var target = this;\n    return target.replace(new RegExp(search, 'g'), replacement);\n};\n\nfunction calculateLHSGreatestWidth(map) {\n  return calculateGreatestWidth(map, 'lhs');\n}\n\nfunction calculateRHSGreatestWidth(map) {\n  return calculateGreatestWidth(map, 'rhs');\n}\n\nfunction calculateGreatestWidth(map, index) {\n  let greatestWidth = 0;\n  for (let key in Object.keys(map)) {\n    if (index === 'lhs') {\n      if (key.length > greatestWidth) {\n        greatestWidth = key.length;\n      }\n    } else if (index === 'rhs') {\n      if (map[key].length > greatestWidth) {\n        greatestWidth = map[key].length;\n      }\n    }\n  }\n  return greatestWidth;\n}\n"],"names":["asciiToUnicode","string","map","options","preprocessMap","undefined","LHSGreatestWidth","calculateLHSGreatestWidth","converted","currIndex","currentDecodedChar","currentOriginalChar","length","slice","currLHSWidth","processingLoop","postProcessed","currChar","baseFound","joiningHold","prebaseBuffer","baseBuffer","prebase","includes","joiner","postbase","Object","keys","composition","rule","replaceAll","processedMap","item","realMap","trim","split","String","prototype","search","replacement","target","replace","RegExp","calculateGreatestWidth","index","greatestWidth","key"],"mappings":"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"}